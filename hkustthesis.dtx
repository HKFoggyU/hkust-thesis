% \iffalse meta-comment
% !TeX program  = XeLaTeX
% !TeX encoding = UTF-8
%
% Copyright (C) 2021-2023 
% by <HKFoggyU> @ GitHub
% 
% It may be distributed and/or modified under the conditions of the
% LaTeX Project Public License (LPPL), either version 1.3c of this
% license or (at your option) any later version.  The latest version
% of this license is in the file
%
%    https://www.latex-project.org/lppl.txt
%
% -----------------------------------------------------------------------
%
% The development version of the template can be found at
%
%    https://github.com/HKFoggyU/hkust-thesis
%
% for those people who are interested.
%
%<*internal>
\iffalse
%</internal>
%
%<*internal>
\fi
\begingroup
  \def\NameOfLaTeXe{LaTeX2e}
\expandafter\endgroup\ifx\NameOfLaTeXe\fmtname\else
\csname fi\endcsname
%</internal>
%
%<*install>
\input l3docstrip.tex
\keepsilent
\askforoverwritefalse

\preamble

Copyright (C) 2021-2023
by <HKFoggyU> @ GitHub

This file may be distributed and/or modified under the conditions of
the LaTeX Project Public License, either version 1.3 of this license
or (at your option) any later version.  The latest version of this
license is in:

   http://www.latex-project.org/lppl.txt

and version 1.3 or later is part of all distributions of LaTeX version
2005/12/01 or later.

To produce the documentation run the original source files ending with `.dtx'
through XeTeX.
    
\endpreamble

\generate{
  \usedir{tex/latex/hkustthesis}
    \file{\jobname.cls}        {\from{\jobname.dtx}{class}}
%</install>
%<*internal>
  \usedir{source/latex/hkustthesis}
    \file{\jobname.ins}        {\from{\jobname.dtx}{install}}
%</internal>
%<*install>
}

\obeyspaces
\Msg{**************************************************************}
\Msg{*                                                            *}
\Msg{* To finish the installation you have to move the following  *}
\Msg{* files into a directory searched by TeX:                    *}
\Msg{*                                                            *}
\Msg{* The recommended directory is TDS:tex/latex/hkustthesis     *}
\Msg{*                                                            *}
\Msg{*     hkustthesis.cls                                        *}
\Msg{*     hkustthesis.ins                                        *}
\Msg{*                                                            *}
\Msg{* To produce the documentation, run the file hkustthesis.dtx *}
\Msg{* through XeLaTeX.                                           *}
\Msg{*                                                            *}
\Msg{* Happy TeXing!                                              *}
\Msg{*                                                            *}
\Msg{**************************************************************}

\endbatchfile
%</install>
%
%<*internal>
\fi
%</internal>
%
%<class>\NeedsTeXFormat{LaTeX2e}
%<class>\RequirePackage{expl3}
%<class>\GetIdInfo  $Id: hkustthesis.dtx 0.4 2021-10-28 00:00:00 +0800  HKFoggyU$
%<class>  { Thesis template for HKUST }
%<class>\ProvidesExplClass{hkustthesis}
%<class>{\ExplFileDate}{\ExplFileVersion}{\ExplFileDescription}
%
%<*driver>
\ProvidesFile{hkustthesis.dtx}
\documentclass[12pt]{ctxdoc}
\usepackage{float,footnote,listings,soul,xcolor,tabularray}
\setlist[1]{labelindent=0.5em}
\UseTblrLibrary{booktabs,siunitx,diagbox}
\DefTblrTemplate{caption-tag}{default}{Table~\hspace{0.25em}\thetable}
\SetTblrStyle{caption-tag}{font=\bfseries}
\DefTblrTemplate{caption-sep}{default}{\quad}

\definecolor{warning}{RGB}{255, 0, 0}
\definecolor{hkustblue}{RGB}{0, 51, 102}
\definecolor{hkustgold}{RGB}{153, 102, 0}
\definecolor{hkustred}{RGB}{237, 27, 47}
\definecolor{hkustgray}{RGB}{204, 204, 204}
\definecolor{hkustviolet}{RGB}{124, 35, 72}
\definecolor{hkustyellow}{RGB}{255, 212, 0}
\definecolor{code-bg}{RGB}{220, 220, 220}

\NewDocumentCommand\mycomment{m}{{\color{gray}#1}}
\NewDocumentCommand\mywarning{m}{{\color{red}#1}}

\lstset{basicstyle=\ttfamily, language=TeX, backgroundcolor=\color{code-bg}}

\DoNotIndex{\\}
\begin{document}
  \DocInput{hkustthesis.dtx}  
  \clearpage
  \PrintChanges
  \clearpage
  \PrintIndex
\end{document}
%</driver>
% \fi
%
% \def\twodigits#1{\ifnum#1<10 0\fi\the#1}
% \def\dashedtoday{\leavevmode\hbox{\the\year-\twodigits\month-\twodigits\day}}
%
% \title{\color{hkustblue}{The \textsc{HkustThesis} class\\ A \hologo{LaTeX}\textcolor{hkustred}{3} template}}
% 
% \author{HKFoggyU}
%
% \date{v0.8.0 @ \dashedtoday\\{\footnotesize 请确保阅读本文档的\href{https://github.com/HKFoggyU/hkust-thesis/releases}{最新版本}}}
%
% \changes{v0.1}{2021/10/21}{Start development based on \href{https://github.com/nju-lug/NjuThesis}{\textsc{NjuThesis}} class}
% \changes{v0.2}{2021/10/24}{Typesett page stye before main body}
% \changes{v0.3}{2021/10/26}{Change \pkg{cref} settings; add some doc}
% \changes{v0.4}{2021/10/27}{Change theorem environment; make the title name of paperlist customizable}
% \changes{v0.4.1}{2021/10/29}{Add documentation for preamble}
% \changes{v0.4.2}{2021/10/31}{Complete documentation}
% \changes{v0.4.3}{2021/11/01}{Fix typos in documentation}
% \changes{v0.5}{2021/11/05}{Add optional TEC list}
% \changes{v0.5.3}{2021/11/06}{Update documentation about TEC list}
% \changes{v0.5.4}{2021/11/08}{Fix loop ending condition for TEC list}
% \changes{v0.6}{2021/11/09}{Update line spacing according to GS, change to oneside, fine tune signature page for different cases}
% \changes{v0.6.1}{2021/11/09}{Fix TEC external examiner problem}
% \changes{v0.6.2}{2021/11/10}{Fix bm conflicts, merge supervisor title into name, update docs}
% \changes{v0.6.3}{2021/11/17}{Change to Co-supervisor, remove supervisor tile name, optimize code performance and style}
% \changes{v0.7.0}{2021/11/23}{cref format issue, bib style, docs and logo}
% \changes{v0.7.1}{2023/08/17}{add presnum in lof and lot, fix typos}
% \changes{v0.7.2}{2023/08/26}{fix vscode setting bug, fix qty conflicts, more friendly docs}
% \changes{v0.7.3}{2023/11/23}{fix twoside bug, default to twoside, fix RPG Handbook link}
% \changes{v0.7.4}{2023/12/01}{fix false typo, add blankpage option, remove redundant setting items, update docs}
% \changes{v0.8.0}{2023/12/04}{update docs about Overleaf part, bump version due to blankpage}
%
% {
% \phantomsection
% \addcontentsline{toc}{section}{封面}
% \maketitle
% }
%
% \def\abstractname{简介}
% \begin{abstract}
% \textsc{HkustThesis} 文档类 (class) 意在为香港科技大学 (HKUST) 的研究型硕士 (MPhil) 和博士 (PhD) 生提供一个尽可能符合 \href{https://fytgs.hkust.edu.hk/academics/Academic-Regulations-and-Requirements/Handbook-for-Research-Postgraduate-Studies/guidelines-thesis-preparation}{RPG Handbook} 要求的毕业论文\hologo{LaTeX}模板。
% \end{abstract}
%
% \vspace{2\baselineskip}
% \def\abstractname{免责声明}
% \begin{abstract}
% 本模板并非官方模板。事实上，除极个别系外，FYTGS 只提供 RPG Handbook 作为总体要求，并不存在官方模板。
% 本模板对潜在的漏洞或与 RPG Handbook 的要求不符的情况不负任何责任。
% 本模板仍在开发中，请从本项目的 \href{https://github.com/HKFoggyU/hkust-thesis/}{GitHub 仓库} 获取更新。
% \end{abstract}
%
% \vspace{2\baselineskip}
% \def\abstractname{致谢}
% \begin{abstract}
% 本项目由 \href{https://github.com/nju-lug/NjuThesis}{\textsc{NjuThesis}} 项目修改而来，并得到了 \href{https://github.com/nju-lug}{NJU LUG} 的帮助。
% \end{abstract}
%%
% \clearpage
%
% \setcounter{tocdepth}{4}
% \tableofcontents
% \clearpage
%
% \EnableDocumentation
%^^A \DisableDocumentation
% 
% \begin{documentation}
%
% \section{模板介绍}\label{sec:introduction}
% \textsc{HkustThesis}是由GitHub组织 \href{https://github.com/HKFoggyU}{@HKFoggyU} 维护的用于香港科技大学研究型硕士 (MPhil) 和博士 (PhD) 生毕业论文排版的\hologo{LaTeX}模板。
%
% \subsection{动机}
% GitHub上已有数个由热心校友（包括但不限于\href{https://github.com/wenbinf/hkust-mphil-thesis}{@wenbinf}、\href{https://github.com/onlytailei/HKUST_latex_thesis_2019}{@onlytailei}、\href{https://github.com/fcyu/HKUST_PhD_MPhil_thesis_Latex}{@fcyu}、\href{https://github.com/Cheedoong/hkust-latex-thesis}{@cheedoong}）制作的毕业论文\hologo{LaTeX}模板。这些模板均使用\hologo{LaTeX2e}语法编写，有些编写时间久远，缺少必要的文档，鲜有后续更新和维护。
%
% 随着时代的进步，更加清晰简明的\hologo{LaTeX3}大大提高了模板的易读性与可维护性\footnote{相比于\hologo{LaTeX2e}；但体验过Typst之后：Typst真香！}。因此，HKFoggyU的成员决定通过\hologo{LaTeX3}语法、参考其它优秀项目，合作编写并维护一个全新的毕业论文模板。
%
% \subsection{文档结构}
% 本文档的前半部分（第\ref{sec:introduction}-\ref{sec:intro2thesis}节）为用户手册，供使用本模板撰写毕业论文的同学们参考。其中，第\ref{sec:intro2latex}-\ref{sec:compile}节介绍了\hologo{LaTeX}和本模板的工具，有\hologo{LaTeX}基础的用户可以跳过；第\ref{sec:intro2thesis}节详细介绍了如何使用本模板撰写毕业论文，建议仔细阅读。
%
% 后半部分（第\ref{sec:implementation}节及以后）为开发手册，供有意了解或贡献源码的开发者参考，普通用户无需阅读。
%
% \section{工欲善其事，必先利其器}\label{sec:intro2latex}
% \mycomment{有\hologo{LaTeX}基础的用户可以跳过本节。}
%
% \subsection{\hologo{LaTeX}入门}
% ``\emph{授人以鱼不如授人以渔。}''
% 本节将更侧重入门\hologo{LaTeX}的方法而非具体步骤。
%
% 对于新手，复旦大学曾祥东的\href{https://github.com/stone-zeng/latex-talk}{《现代\hologo{LaTeX}入门讲座》} 和北京大学刘海洋的 \href{https://www.bilibili.com/video/BV1s7411U7Pr}{\hologo{LaTeX}不快速的入门}（视频讲座）是两个非常优秀的入门教程；推荐先通读前者（内容较短），如果不喜欢文字内容，可以观看后者。另外，刘海洋的《\hologo{LaTeX}入门》内容详尽充实，可以作为日常写作时的工具书。
% 
% ``\emph{吾生也有涯，而知也无涯。}''
% \hologo{LaTeX}的参考资料浩如烟海。没有人能把这些资料都看完才去开始使用\hologo{LaTeX}，因此，学会使用 Google/ChatGPT 等工具解决眼前的问题，比通读各种\hologo{LaTeX}教程更加重要。
%
% 作为新手用户，不要有 ``\hologo{LaTeX}要写代码'' 这种思想负担，也不要害怕编译报错，这些不影响之前输入的文字\footnote{比Word突然卡死崩溃不知道好到哪里去了（}，遇到问题去Google或者问ChatGPT即可。
%
% \subsection{\hologo{LaTeX}版本}
% \subsubsection{在线编译}
% 如果电脑上还未安装任何\hologo{LaTeX}发行版，可以使用在线版\hologo{LaTeX}服务 \href{https://www.overleaf.com/}{Overleaf} 进行初步体验，以避免学习热情被安装配置环境所熄灭。可以直接跳转到第\ref{sec:intro2thesis}节继续阅读。
%
% \mywarning{注意：} Overleaf免费版开始对文章长度和项目大小逐渐施加限制，近期\footnote{2023年11月}毕业的同学反映，其 thesis 项目\footnote{95页，80MB大小}已经需要购买会员服务。因此建议准备一份本地安装的\hologo{LaTeX}发行版以防万一。
%
% \subsubsection{本地编译}
% 如果希望不依赖网络工作，请选择 \href{https://www.tug.org/texlive/}{\hologo{TeXLive}} \textbf{或} \href{https://miktex.org/download}{\hologo{MiKTeX}}，下载并安装其最新版本。前者安装体积较大（$\sim$ 5 GB）但是可以做到完全离线使用；后者体积较小但在第一次编译时需要联网下载宏包（后续编译无需联网）。
%
% 本模板要求的\hologo{LaTeX}版本为 \hologo{TeXLive} ($\geq$2021) 或 \hologo{MiKTeX} ($\geq$4.4)。尽管某些低版本的发行版可以编译通过，但可能存在一些未被发现的问题。
%
% 本模板在各平台、各\hologo{LaTeX}发行版上的编译情况如表 (\ref{tab:environment}) 所示。
%
% \begin{table}[ht]
%   \caption{不同平台编译测试结果}
%   \label{tab:environment}
%   \centering
%   \begin{tabular}{lll}
%     \toprule
%     Platform & TeX & Test \\
%     \midrule
%     Overleaf                 & \hologo{TeX}\,Live 2021/2/3  & Pass \\
%     Arch Linux (2023.11)     & \hologo{TeX}\,Live           & Pass \\
%     Windows 10/11            & \hologo{TeX}\,Live 2021      & Pass \\
%     macOS 10.15              & \hologo{TeX}\,Live 2021      & Pass \\
%     Windows 10               & \hologo{TeX}\,Live 2020      & \mywarning{\verb|ltxhook| problem} \\
%     Ubuntu 20.04             & \hologo{TeX}\,Live 2021      & Pass \\
%     Windows 11               & \hologo{MiKTeX} 4.9          & Pass \\
%     Windows 10               & \hologo{MiKTeX} 4.4          & Pass \\
%     \bottomrule
%   \end{tabular}
% \end{table}
%
% \subsection{编辑器}
% \mycomment{本小节仅针对本地编译用户。Overleaf 用户使用浏览器，无需安装编辑器。}
%
% 本项目建议使用 \href{https://code.visualstudio.com/download}{Visual Studio Code} 编辑器并安装 \href{https://marketplace.visualstudio.com/items?itemName=James-Yu.latex-workshop}{LaTeX Workshop} 插件以获得良好的编辑体验。
%
% 此外，建议使用支持热重载（热刷新）的 PDF 阅读器如 \href{https://www.sumatrapdfreader.org/download-free-pdf-viewer}{Sumatra PDF}。不支持热重载的 PDF 阅读器如 Adobe Acrobat 在打开 pdf 文件后就会锁定 pdf 修改权限，必须关闭才能更新 pdf，因此不便于此场景使用。
%
% \section{编译本项目}\label{sec:compile}
%
% \subsection{获取本模板}
% \begin{itemize}
% \item (针对用户) 请在本项目的 \href{https://github.com/HKFoggyU/hkust-thesis/releases/latest}{GitHub Release} 页面下载名为 \file{hkust-thesis-v*.zip} 的压缩文件。
% \item (针对开发者) 如果希望第一时间获取更新，可以克隆本项目\href{https://github.com/HKFoggyU/hkust-thesis.git}{仓库}，并运行 \colorbox{code-bg}{\lstinline|xetex hkustthesis.dtx|} 以生成 \file{hkustthesis.cls} 文件。
% \end{itemize}
%
% \subsection{在线编译：使用 Overleaf}
% \begin{enumerate}
%  \item 将下载得到的 \file{hkust-thesis-v*.zip} 文件上传到 Overleaf 网站。上传完毕后将自动进入该项目页面。
%  \item 点击左上方 ``Menu/菜单'' 按钮，在 ``settings/设置'' 中选择如下设置：
%   \begin{itemize}
%    \item Compiler: XeLaTeX
%    \item TeX Live version: 2023
%   \end{itemize}
%  \item 返回项目页面，点击 `` Recompile/重新编译 '' 按钮进行编译。
% \end{enumerate}
%
% \subsection{本地编译}
% \subsubsection{（推荐）VSCode}
% 本项目提供了一份 配置好的 \file{.vscode/settings.json} 文件。在安装了 LaTeX Workshop 插件的 VSCode 中，点击 \hologo{TeX} 侧栏，在 ``COMMANDS'' 中 选择 ``build recipe'' 为 ``build_mythesis'' 即可进行编译。
%
% 下面提供了几种其它编译方式，供开发者或有其它偏好的用户使用。
%
% \subsubsection{latexmk}
% 本项目提供了一个定制的 \file{latexmkrc} 配置文件以进行自动化构建。分别运行
% \begin{ctexexam}
%   latexmk
%   latexmk -c
% \end{ctexexam}
% 以进行编译和删除编译中间产物。
%
% \subsubsection{Make}
% 本项目提供了一个 \file{Makefile}。分别运行
% \begin{ctexexam}
%   make
%   make clean
% \end{ctexexam}
% 以进行编译和删除编译中间产物。
%
% \subsubsection{\hologo{XeLaTeX}手动编译}
% \begin{ctexexam}
%   xelatex mythesis.tex
%   biber mythesis
%   xelatex mythesis.tex
%   xelatex mythesis.tex
% \end{ctexexam}
%
% \section{撰写论文}\label{sec:intro2thesis}
%
% \subsection{文件结构}
%
% 下载得到的压缩文件内部的文件结构应如表 (\ref{tab:fileStruture}) 所示。其中 \file{figures/} 文件夹如不存在请自行创建。
%
% \begin{table}[H]
%   \caption{\cls{hkustthesis}文件结构}
%   \label{tab:fileStruture}
%   \centering
%   \begin{tabular}{lll}
%     \toprule
%     文件名                               & 类型   & 说明                 \\
%     \midrule
%     \file{.vscode/}                      & 文件夹 & VSCode 配置文件夹    \\
%     \color{hkustgold}\file{chapters/}    & 文件夹 & 存放论文各章节       \\
%     \color{hkustgold}\file{figures/}     & 文件夹 & 存放论文所用图片     \\
%     \file{hkustthesis.cls}               & 文件   & 模板文档类           \\
%     \file{latexmkrc}                     & 文件   & latexmk 配置文件     \\
%     \file{LICENSE}                       & 文件   & 许可证               \\
%     \color{hkustgold}\file{mythesis.bib} & 文件   & 存放论文所用参考文献 \\
%     \color{hkustgold}\file{mythesis.tex} & 文件   & 论文主文件           \\
%     \file{README.md}                     & 文件   & 自述文件             \\
%     \bottomrule
%   \end{tabular}
% \end{table}
%
% 各文件(夹)的作用已经给出。对于使用本模板撰写毕业论文的用户，只需要修改表 (\ref{tab:fileStruture}) 中\textcolor{hkustgold}{金色的文件（夹）}。
%
% \subsection{主文件介绍}
% \file{mythesis.tex}是本模板的 \hologo{TeX} 主文件。下面将给出主文件内容的解释。
%
% \subsubsection{模板选项}
% 模板选项是 \verb|\documentclass[]{hkustthesis}| 中方括号 \verb|[]| 内的选项。
%
% 本模板定义了3个模板选项：
%
% \begin{function}{customlatinfont}
%  \begin{syntax}
%   customlatinfont = <windows|macos|gyre|none>
%  \end{syntax}
% 自定义西文字体。
% \end{function}
% 该选项默认被 \verb|%| 注释掉，使模板可以在不同平台上自动选择对应的字体 (不同选项使用的字体如表 (\ref{tab:latinfontset}) 所示)。
% 如果用户希望该模板在所有平台上都使用同样的字体（前提是所用字体存在），可以取消该行注释并修改为希望使用的选项。
% 如果用户希望完全由自己设定字体，则可以填 \opt{none}，再通过 \pkg{fontspec} 宏包手动设置字体。
% \begin{table}[htbp]
%   \centering
%   \caption{西文字体清单}
%   \label{tab:latinfontset}
%   \begin{tabular}{llll}
%     \toprule
%     选项     & 衬线体 & 无衬线体 & 等宽字体 \\
%     \midrule
%     windows  & Times~New~Roman           & Arial                   & Courier~New \\
%     macos    & Times~New~Roman           & Arial                   & Menlo \\
%     gyre     & \Hologo{TeX}~Gyre~Termes  & \Hologo{TeX}~Gyre~Heros & \Hologo{TeX}~Gyre~Cursor \\
%     \bottomrule
%   \end{tabular}
% \end{table}
%
% \begin{function}{custombibstyle}
%  \begin{syntax}
%   custombibstyle = <(ieee)|nature|science|apa|mla|phys|chem-acs|nejm>
%  \end{syntax}
% 自定义参考文献条目样式。
% \end{function}
% 该选项默认被 \verb|%| 注释掉。\opt{ieee} 为默认样式。如果希望使用的样式不在此列表，可以阅读 \pkg{biblatex} 的文档并自行修改模板代码。
%
% \begin{function}{displaycommittee}\label{opt:displaycommittee}
%  \begin{syntax}
%   displaycommittee = <(false)|true>
%  \end{syntax}
% 设置是否在签名页显示答辩委员会成员列表。
% \end{function}
% 该选项默认值 \verb|false|，因为 RPG Handbook 提供的示例签名页没有要求列出答辩委员会成员。
% 但某些院系 (如 ECE) 要求在签名页显示答辩委员会成员列表，则需要设置为 \verb|true|，以及需要在下文提及的 \opt{reviewer}、\opt{reviewerdept} 和 \opt{reviewerext} 选项中填写委员会成员信息。
%
% \begin{function}[added=2023-12-01]{blankpage}
%  \begin{syntax}
%   blankpage = <(true)|false>
%  \end{syntax}
% 设置是否插入空白页以确保章节标题位于奇数页。
% \end{function}
% RPG Handbook 要求章节 (Chapter) 标题应当位于新的一页；兼顾打印版本的美观，该选项默认开启，使得章节标题确保处于奇数页。但是在撰写论文的过程中，太多空白页不便于查看，因此可以设置为 \verb|false| 以便自己预览。在最终提交前，请将其改回 \verb|true|。
%
% \subsubsection{论文信息}
%
% \begin{function}{\hkustsetup}
%  \begin{syntax}
%   \tn{hkustsetup}\Arg{键值列表}
%  \end{syntax}
% 论文必要信息。
% \end{function}
% 此选项的内容是以英文逗号 \verb|,| 分隔的键值列表，定义了该论文的必要信息。每一项等号左边为变量名，右边为由花括号 \verb|{}| 包裹的变量值。其中标为\textcolor{hkustblue}{蓝色的选项}为可选填项。如果某一项的值不需要填，可以留空，但花括号 \verb|{}| 仍需要保留。同理，标为\textcolor{hkustblue}{蓝色的文字}为可选阅读项，只有填写可选项的用户才需要阅读。
%
% \begin{function}{degree}
%  \begin{syntax}
%   degree              = \Arg{phd|mphil}
%  \end{syntax}
% 学位。
% \end{function}
%
% \begin{function}{title}
%  \begin{syntax}
%   title               = \Arg{论文标题}
%  \end{syntax}
% 论文标题。其中 \verb|\\| 用于换行，如不需要可以删去。
% \end{function}
%
% \begin{function}{keywords}
%  \begin{syntax}
%   \textcolor{hkustblue}{keywords}            = \Arg{关键词}
%  \end{syntax}
% 关键词列表。关键词列表以英文逗号分隔。
% \end{function}
%
% \begin{function}{author, school, department, program, major}
%  \begin{syntax}
%   author              = \Arg{作者}
%   \textcolor{hkustblue}{school}              = \Arg{学院}
%   department          = \Arg{系/部门}
%   program             = \Arg{项目名称}
%   \textcolor{hkustblue}{major}               = \Arg{专业}
%  \end{syntax}
% 作者。\\
% 学院信息。如 ``School of Engineering''。\\
% 系/部门的全名。需填写为 ``Department/Division of XXX''。\\
% 项目名称。参考 SIS 中的 ``name of program''。通常和系/部门同名。\\
% 专业方向。参考 SIS 中的 ``major''。
% \end{function}
%
% \begin{function}{supervisor, co-supervisor}
%  \begin{syntax}
%   supervisor          = \Arg{导师 头衔 姓名}
%   co-supervisor       = \Arg{联培导师 头衔 姓名}
%  \end{syntax}
% 导师信息。如无Co-supervisor，可以留空。需填写为 ``Prof. XXX''。
% \end{function}
%
% \begin{function}{submit-month, submit-date, defend-date}
%  \begin{syntax}
%   submit-month        = \Arg{论文提交年月}
%   submit-date         = \Arg{论文提交日期}
%   defend-date         = \Arg{论文答辩日期}
%  \end{syntax}
% 提交时间和答辩时间。其中，\opt{submit-month} 请只填写 ``月~年''，而 \opt{submit-date} 和 \opt{defend-date} 请填写 ``日~月~年''。
% \end{function}
%
% \begin{function}{depthead, reviewer, reviewerdept, reviewerext}
%  \begin{syntax}
%   depthead            = \Arg{系/部门主任}
%   \textcolor{hkustblue}{reviewer}            = \Arg{答辩委员会成员}
%   \textcolor{hkustblue}{reviewerdept}        = \Arg{答辩委员会成员所属机构}
%   \textcolor{hkustblue}{reviewerext}         = \Arg{答辩委员会外部成员}
%  \end{syntax}
% 签名页信息。\\
% 其中，\opt{depthead} 需填写完整信息，如 ``Prof. XXX, Head of Department/Division''。
% 关于\textcolor{hkustblue}{答辩委员会 (TEC)}：
%
% 某些系要求在签名页列出TEC成员列表，则需要修改上文 (\ref{opt:displaycommittee}处) 提及的 \opt{displaycommittee} 选项为 \opt{true}，并填写 \opt{reviewer}、\opt{reviewerdept}项，PhD 还需填写 \opt{reviewerext}项。一般地，MPhil的TEC需要4名成员，PhD的TEC需要6名成员 (含1名外部成员)。可按需增删此处的内容。实测最大支持7名成员。
%
% \textcolor{hkustblue}{\textbf{注意：}} \opt{reviewer} 和 \opt{reviewerdept} 中的每个条目之间需要使用英文逗号分隔；但如果某一条目的部分内容里包含英文逗号，比如 \opt{reviewerext} 中的外部大学名称，则需要用花括号将那一整个部分包裹，否则 \hologo{LaTeX} 程序会在逗号处截断，将其当作两个条目。详见下文给出的示例中的 \opt{reviewerext} 的写法。
%
% \textcolor{hkustblue}{\textbf{注意：}} 如果填写PhD的TEC内容，其中 ``External Examiner'' 的所属机构中的 ``Department'' 和 ``University'' 之间的换行符 \verb|\\| 不能删去，否则会使得对齐出错。如果确实没有第二行内容，可以在 \verb|\\| 后使用 \verb|\phantom{xxx}| 作为占位 (这个命令会占据与 \verb|xxx| 同样大小的空间但不实际显示)。
%
% \end{function}
%
% \begin{function}{city}
%  \begin{syntax}
%   city                = \Arg{地点}
%  \end{syntax}
% 城市。通常为 ``Hong Kong''。
% \end{function}
%
% 本文档给出一个示例（此处使用了非真实信息以防用户忘记修改）以供参考：
%
% \begin{ctexexam}
%   \hkustsetup {
%     info = {
%       degree        = {phd},
%       title         = {Triggering\\the Forth Impact},
%       keywords      = {Neon, Genesis, Evangelion},
%       author        = {Cruel Angel},
%       school        = {School of SEELE},
%       department    = {Department of NERV},
%       program       = {Human Instrumentality Project},
%       major         = {},
%       supervisor    = {Prof. Adams},
%       co-supervisor = {Prof. Lilith},
%       submit-month  = {August 2021},
%       submit-date   = {13 August 2021},
%       defend-date   = {8 March 2021},
%       depthead      = {Prof. Ikari Yui, Head of Department},
%       reviewer      = {Prof. AAA (Chairperson), 
%                       Prof. BBB (Supervisor),
%                       Prof. CCC (Co-supervisor),
%                       Prof. DDD,
%                       Prof. EEE},
%       reviewerdept  = {Department of Electronic and Computer Engineering,
%                       Department of ECE,
%                       Department of ECE,
%                       Department of ECE,
%                       Department of Physics},
%       reviewerext   = {Prof. FFF (External Examiner),
%                        Department of EE\\{University of UU, at VV}},
%       city          = {Geo Front},
%     }
%   }
% \end{ctexexam}
%
% \subsubsection{导言区剩余部分}
% \begin{itemize}
%  \item 用户可以自行添加所需的宏包、设置和其它命令。
%  \item \verb|\addbibresource{mythesis.bib}| 导入了存放引用文献的 bib 文件。
% \end{itemize}
%
% \textcolor{hkustblue}{\textbf{注意：}} 本模板使用 \pkg{unicode-math} 设置数学环境字体，请不要使用会与之产生冲突的 \pkg{bm} 宏包，否则会报错。事实上，在 \hologo{XeTeX} 引擎下，\pkg{bm} 已经过时。对于 \pkg{bm} 宏包中的常用命令 \verb|\bm|，本模板已经设置了一个别名，用户可以在正文中直接使用 \verb|\bm|。除此之外，如果还有需要使用的 \pkg{bm} 宏包中的命令，请自行设置别名。
%
% \subsubsection{正文区}
% 正文区按顺序定义或插入了组成论文的各个组件、章节；用户在 \file{chapters/} 文件夹下修改或新增章节文件后，需要检查主文件中对应的部分是否正确。
%
% 这样设置文件结构的优点是使得主文件结构清晰可见、各章节便于修改；但如果用户有自己的喜好，也不必拘泥于本模板提供的结构，可以自由发挥。
%
% \subsection{各章节}
%
% 在 \verb|\mainmatter| 之后的内容是以章节的形式呈现的论文正文和附录部分，一般以 Introduction、Chapters、Conclusions、 References 和 Appendix 的顺序组织文字。用户可以根据自己的实际情况修改、增加、删除、重命名对应的章节文件，并确保主文件中使用 \verb|\input{}| 的部分
% \begin{ctexexam}
%   \input{chapters/Introduction.tex}
%   \input{chapters/...}
%   \input{chapters/Conclusions.tex}
%   \printbibliography[heading=bibintoc,title=References]
%   \appendix
%   \input{chapters/Appendix_xxx.tex}
% \end{ctexexam}
% 与之对应。
%
% 值得指出的是，\file{mythesis.tex} 文件所在的目录是编译时的根目录，因此即使在 \file{chapters/xxx.tex} 文件中插入图片，也应该使用 \verb|{figures/xxx.png}| 而非 \verb|{../figures/xxx.png}| 作为图片的路径。
%
% \file{mythesis.tex} 文件和 \file{chapters} 文件夹内的文件给出了一些示例，用户可以基于这些文件撰写自己的毕业论文。其中部分章节文件内的 \verb|\blindtext| 命令用来生成一段用于测试排版效果的 ``乱数假文'' (lorem ipsum)，正式撰写论文时请将其删去。
%
% \vfill
%
% \textbf{以下内容供开发者参考。普通用户无需阅读，可以开始撰写毕业论文了！}
%
% \end{documentation}
%
% \clearpage
%
% \begin{implementation}
%
% \section{Implementation}\label{sec:implementation}
%
% \verb|@@| 在 \pkg{l3docstrip} 中表示名空间，在删除注释生成格式文件时会被等号后的字段替换，如在本模板\pkg{hkustthesis}中 |@@=hkust|。
% 尖括号包裹的|<*class>||</class>|用来指定某段代码属于哪个文件。
%
%    \begin{macrocode}
%<@@=hkust>
%<*class>
%    \end{macrocode}
%
% \subsection{定义常量}
%
% \begin{macro}{\@@_define_name:nn}
%
% 用来定义默认名称的辅助函数。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_define_name:nn #1#2
  { \tl_const:cn { c_@@_name_ #1 _tl } {#2} }
%    \end{macrocode}
% \end{macro}
%
% 默认名称。注意空格是忽略掉的。
%    \begin{macrocode}
\clist_map_inline:nn
  { { pdf_creator } { LaTeX~with~hkustthesis~class }, }
  { \@@_define_name:nn #1 }
\clist_map_inline:nn
  { { keywords } { Keywords:~ }, }
  { \@@_define_name:nn #1 }
%    \end{macrocode}
%
% \subsection{模板选项}
%
% 用于配置模板选项的宏包。
%    \begin{macrocode}
\RequirePackage{xparse,xtemplate,l3keys2e}
%    \end{macrocode}
%
% \begin{variable}{\l_@@_info_degree_tl}
% 用于存储学位名称的变量，注意宏的命名，\verb|l|代表局部变量，\verb|g|代表全局变量。
%    \begin{macrocode}
\tl_new:N \l_@@_info_degree_tl
%    \end{macrocode}
% \end{variable}
%
% \begin{variable}{\g_@@_latin_fontset_tl, \g_@@_bib_style_tl}
% 用于存储所用字体名称和参考文献样式的全局变量。
%    \begin{macrocode}
\tl_new:N \g_@@_latin_fontset_tl
\tl_new:N \g_@@_bib_style_tl
\tl_new:N \g_@@_disp_committee_tl
%    \end{macrocode}
% \end{variable}
%
% 学位信息的设置。
%    \begin{macrocode}
\keys_define:nn { hkust }
{
%    \end{macrocode}
%
% \begin{macro}{customlatinfont}
% 定义字体选项。
%    \begin{macrocode}
  customlatinfont   .choices:nn   =
  { gyre, macos, windows, none }
  { \tl_set_eq:NN \g_@@_latin_fontset_tl \l_keys_choice_tl },  
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{custombibstyle}
% 定义参考文献样式。
%    \begin{macrocode}
  custombibstyle    .choices:nn   =
  { ieee, nature, science, apa, mla, phys, chem-acs, nejm }
  { \tl_set_eq:NN \g_@@_bib_style_tl \l_keys_choice_tl },  
  custombibstyle    .initial:n    = ieee,
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{displaycommittee}
% 显示委员会成员列表。
%    \begin{macrocode}
  displaycommittee    .choices:nn   = { true, false }
  { \tl_set_eq:NN \g_@@_disp_committee_tl \l_keys_choice_tl },  
  displaycommittee    .initial:n    = false,
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{blankpage}
% 是否增加空白页以确保章节标题在奇数页开始。
%    \begin{macrocode}
    blankpage    .choices:nn      = { true, false }
    { \tl_set_eq:NN \g_@@_blankpage_tl \l_keys_choice_tl },  
    blankpage    .initial:n       = true,
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\ProcessKeysOptions}
% 在定义完全部设置以后从tex文件导言区输入参数。
%    \begin{macrocode}
\ProcessKeysOptions { hkust }
%    \end{macrocode}
% \end{macro}
%
% \subsection{论文信息}
% 输入论文的必要信息。
%    \begin{macrocode}
\keys_define:nn { hkust }
{ info               .meta:nn = { hkust / info } { #1 } }
%    \end{macrocode}
%
%    \begin{macrocode}
\keys_define:nn { hkust / info }
{
%    \end{macrocode}
%
% \begin{macro}{info/degree}
% 学位名称：phd 或 mphil。
%    \begin{macrocode}
  degree            .tl_set:N = \l_@@_info_degree_tl,
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{info/title}
% 论文标题。经测试，本模板最大支持3行标题，如果多于3行，有部分情况会出现溢出页面的问题。
%    \begin{macrocode}
  title             .tl_set:N = \l_@@_info_title_tl,
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{info/keywords}
% 关键词。
%    \begin{macrocode}
keywords         .clist_set:N = \l_@@_info_keywords_clist,
%    \end{macrocode}
% \end{macro}
% 
% \begin{macro}{info/author,info/school,info/department,info/program,info/major}
% 作者、学院、系/部门、项目、专业。
%    \begin{macrocode}
  author            .tl_set:N = \l_@@_info_author_tl,
  school            .tl_set:N = \l_@@_info_school_tl,
  department        .tl_set:N = \l_@@_info_department_tl,
  program           .tl_set:N = \l_@@_name_of_program_tl,
  major             .tl_set:N = \l_@@_major_tl,
%    \end{macrocode}
% \end{macro}
%  
% \begin{macro}{info/supervisor,info/co-supervisor}
% 导师。
%    \begin{macrocode}
  supervisor        .tl_set:N = \l_@@_info_supervisor_tl,
  co-supervisor     .tl_set:N = \l_@@_info_co_supervisor_tl,
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{info/submit-month,info/submit-date,info/defend-date,info/depthead,info/reviewer,info/reviewerdept,info/reviewerext,info/city}
% 提交和答辩。
%    \begin{macrocode}
  submit-month      .tl_set:N = \l_@@_submit_month_tl,
  submit-date       .tl_set:N = \l_@@_submit_date_tl,
  defend-date       .tl_set:N = \l_@@_defend_date_tl,
  depthead          .tl_set:N = \l_@@_info_depthead_tl,
  reviewer       .clist_set:N = \l_@@_info_reviewer_clist,
  reviewerdept   .clist_set:N = \l_@@_info_reviewer_dept_clist,
  reviewerext    .clist_set:N = \l_@@_info_reviewer_ext_clist,
  city              .tl_set:N = \l_@@_info_city_tl,
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\hkustsetup}
% 定义用于设置个人信息的命令。
%    \begin{macrocode}
\NewDocumentCommand \hkustsetup { m }
{ \keys_set:nn { hkust } { #1 } }
%    \end{macrocode}
% \end{macro}
%
% \subsection{载入文档类}
% 
% 使用\pkg{book}文档类。
%    \begin{macrocode}
\str_if_eq:NNTF { \g_@@_blankpage_tl } { true }
{
    \PassOptionsToClass{a4paper,12pt,UTF8,twoside}{book}
}{
    \PassOptionsToClass{a4paper,12pt,UTF8,oneside}{book}
}
\LoadClass{book}
%    \end{macrocode}
%
% \subsection{载入宏包}
%
% 载入各种宏包。
% \pkg{emptypage}用于清除空白页的页码。
%    \begin{macrocode}
\RequirePackage
{
  geometry,
  caption,
  floatrow,
  float,
  setspace,
  lastpage,
  emptypage,
  fancyhdr,
  makecell
}
%    \end{macrocode}
%
% 此处为行距设置，FYTGS的邮件确认是 Word 中的 1.5 倍行距。\\
% 关于行距，12pt的 Times~New~Roman 文字在Word里的单倍行距对应的 PDF 行距是1.15，1.5倍 Word 行距对应的 PDF 行距是1.72；而在 \hologo{LaTeX} 中设置 linespread = 1 时生成的 PDF 的行距是 1.2。所以要想得到 1.5 倍 Word 行距 (即 1.72 倍 PDF 行距)，需要设置的 linespread 为：
% \[ \frac{1.72}{1.2} = 1.433\]
% 而由于单倍行距在 Word 和 \hologo{LaTeX}生成的PDF 中差别很小，故使用了 \verb|\singlespacing| 命令实现。
%    \begin{macrocode}
\linespread{1.43}
%^^A \onehalfspacing
%^^A \setstretch{1.5}
%^^A \setlength{\baselineskip}{18pt}
%    \end{macrocode}
%
% 标题、目录和链接。
%    \begin{macrocode}
\RequirePackage[explicit]{titlesec} % typesetting titles of chap/sec/...
\RequirePackage[titles]{tocloft}
\RequirePackage[hyphens]{url} % generate better linebreaks in the url
%    \end{macrocode}
%
% 用于特定学科的包。
%    \begin{macrocode}
\RequirePackage{siunitx}            % 用于书写单位符号
\RequirePackage[version=4]{mhchem}  % 用于绘制分子式
\RequirePackage{physics}            % Physics package
\AtBeginDocument{\RenewCommandCopy\qty\SI}
\RequirePackage{braket}             % for Dirac notation
%    \end{macrocode}
%
% 用于生成可以被插入书签的LaTeX logo。
%    \begin{macrocode}
\RequirePackage{hologo} 
%    \end{macrocode}
%
%    \begin{macrocode}
% \RequirePackage{needspace} % prevent page break after sectioning
% \RequirePackage{xspace} % Better print trailing whitespace
%    \end{macrocode}
%
% \pkg{amsmath}必须在\pkg{unicode-math}前加载。
% \pkg{unicode-math}指定了\hologo{XeTeX}和\hologo{LuaTeX}下所使用的数学字体。
% 用于配置数学环境的\pkg{mathtools}会与\pkg{unicode-math}发生冲突，此处手动消除其警告。
%    \begin{macrocode}
\RequirePackage{amsmath,amsthm,mathtools,thmtools}
\RequirePackage[
  warnings-off={mathtools-colon,mathtools-overbracket}
]{unicode-math}
%    \end{macrocode}
%
% 配置图片、表格、代码、列表环境。
%    \begin{macrocode}
\RequirePackage{graphicx,subcaption,wrapfig,tikz}
\DeclareGraphicsExtensions{.pdf,.eps,.jpg,.png}
\RequirePackage{booktabs,multirow,multicol,listings,enumitem}
%    \end{macrocode}
%
% 必须以该顺序加载以下两个关于引用的包。
%    \begin{macrocode}
\RequirePackage[
  hidelinks,
  bookmarksnumbered = true,
  psdextra          = true,
  unicode           = true,
  colorlinks        = true,
  linkcolor         = black,
  urlcolor          = blue,
  citecolor         = red,
  anchorcolor       = blue,
  ]{hyperref}
\RequirePackage[capitalise,nameinlink,noabbrev]{cleveref}
%    \end{macrocode}
%
% 生成 ``Lorem ipsum'' 测试文字。
%    \begin{macrocode}
\RequirePackage{blindtext} 
%    \end{macrocode}
%
% \subsection{字体设置}
%
% 导入 \pkg{fontspec} 宏包。
%    \begin{macrocode}
\RequirePackage{fontspec} 
%    \end{macrocode}
%
% \subsubsection{操作系统检测}
%
% \begin{variable}{\g_@@_load_system_fontset_bool}
% 定义用于判断是否需要载入系统预装字体的变量。
%    \begin{macrocode}
\bool_new:N \g_@@_load_system_fontset_bool
%    \end{macrocode}
% \end{variable}
%
% 判断用户是否自定义了英文字体。如果未定义，则使用系统预装字体覆盖字体选项。
%    \begin{macrocode}
\tl_if_empty:NTF \g_@@_latin_fontset_tl
  { \bool_gset_true:N \g_@@_load_system_fontset_bool }  
  { }
%    \end{macrocode}
%
% 进行系统检测。
% 检测 Windows 的命令由\pkg{l3kernal}提供，
% 检测 macOS 的命令 modified from \pkg{ctex}，
% 以特定字体判断 macOS 系统。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_if_platform_macos:TF
  { \file_if_exist:nTF { /System/Library/Fonts/Menlo.ttc } }
%    \end{macrocode}
%
% 这两种情况外的系统被判断为 Linux，一律使用自由字体。
%    \begin{macrocode}
\bool_if:NT \g_@@_load_system_fontset_bool
{
  \sys_if_platform_windows:TF
  { \tl_set:Nn \g_@@_latin_fontset_tl { windows } }
  {
    \@@_if_platform_macos:TF
    { \tl_set:Nn \g_@@_latin_fontset_tl { macos } }
    { \tl_set:Nn \g_@@_latin_fontset_tl { gyre  } }
  }
}
%    \end{macrocode}
%
% \subsubsection{定义英文字库}
%
% 接下来逐个定义所需要使用的字库。
%
% \begin{macro}{\@@_load_latin_font_windows:}
% Windows 西文字体。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_load_latin_font_windows:
{
  \setmainfont{Times~New~Roman}
  \setsansfont{Arial}
  \setmonofont{Courier~New}[Scale=MatchLowercase]
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\@@_load_latin_font_macos:}
% macOS 西文字体。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_load_latin_font_macos:
{
  \setmainfont{Times~New~Roman}
  \setsansfont{Arial}
  \setmonofont{Menlo}[Scale=MatchLowercase]
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\@@_load_latin_font_gyre:}
% 开源的 gyre 西文字体。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_load_latin_font_gyre:
{
  \setmainfont{texgyretermes}[
    Extension=.otf,
    UprightFont=*-regular,
    BoldFont=*-bold,
    ItalicFont=*-italic,
    BoldItalicFont=*-bolditalic]
  \setsansfont{texgyreheros}[
    Extension=.otf,
    UprightFont=*-regular,
    BoldFont=*-bold,
    ItalicFont=*-italic,
    BoldItalicFont=*-bolditalic]
  \setmonofont{texgyrecursor}[
    Extension=.otf,
    UprightFont=*-regular,
    BoldFont=*-bold,
    ItalicFont=*-italic,
    BoldItalicFont=*-bolditalic,
    Scale=MatchLowercase,
    Ligatures=CommonOff]
}
%    \end{macrocode}
% \end{macro}
%
% \subsubsection{载入指定字库}
%
% 载入字体命令。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_load_font:
{ \use:c { @@_load_latin_font_ \g_@@_latin_fontset_tl : } }
%    \end{macrocode}
%
% 载入设置的字体。
%    \begin{macrocode}
\@@_load_font:
%    \end{macrocode}
%
% 设置数学字体 (XITS, 或者 \href{https://www.stixfonts.org}{STIX}, 与 Times New Roman 最为相近)。
%    \begin{macrocode}
% \setmathfont{STIXTwoMath-Regular}[Extension = .otf]
\setmathfont{XITSMath-Regular}[
  BoldFont = XITSMath-Bold,
  Extension = .otf]
\setmathfont{latinmodern-math.otf}[range={cal,bb,frak}]
%    \end{macrocode}
%
% \subsection{页面布局}
%
% \subsubsection{页边距}
%
% 使用\pkg{geometry}设置页边距。
%    \begin{macrocode}
\geometry{vmargin = 2.5 cm, hmargin = 2.5 cm}
%    \end{macrocode}
%
% \subsubsection{页眉页脚}
% 
%    \begin{macrocode}
\fancypagestyle{hkustplain}{
   \fancyhead{}               
   \fancyfoot[C]{\thepage}
}
%    \end{macrocode}
%
% 载入页眉页脚设置。此处\tn{flushbottom}是为了防止目录页出现underfull \tn{vbox}信息。
%    \begin{macrocode}
\tl_set:Nn \headrulewidth {0pt}
\tl_set:Nn \footrulewidth {0pt}
\AtBeginDocument{\pagestyle{hkustplain}\flushbottom}
%    \end{macrocode}
%
% \subsection{章节标题}
% 
% 由\pkg{titlesec}设置。
%    \begin{macrocode}
\titleformat
  {\chapter}
  [display]
  {\centering\onehalfspacing\Large\bfseries\selectfont}
  {\MakeUppercase{\chaptertitlename}~\thechapter}
  {10pt}
  {\MakeUppercase{#1}}
\titlespacing{\chapter}{0pt}{20pt}{20pt}
%    \end{macrocode}
%
% \subsection{目录}
% 使用\pkg{tocloft}定制目录文字格式。
%    \begin{macrocode}
\cftsetpnumwidth{2em}
\renewcommand{\cftchapfont}{\rmfamily\selectfont}
\renewcommand{\cftchappagefont}{\rmfamily\selectfont}
\renewcommand{\cftchapdotsep}{\cftdotsep}
\renewcommand{\cftchapleader}{\cftdotfill{\cftchapdotsep}}
\renewcommand{\cftchappresnum}{Chapter~}
\renewcommand{\cftdot}{}
\setlength{\cftsecindent}{6em}
\setlength{\cftsubsecindent}{8em}
\setlength{\cftchapnumwidth}{6em}
\setlength{\cftsecnumwidth}{2em}
\setlength{\cftsubsecnumwidth}{3em}
\g@addto@macro\appendix{%
  \addtocontents{toc}{%
    \protect\renewcommand{\protect\cftchappresnum}{\appendixname\space}%
  }%
}
%    \end{macrocode}
%
% \begin{macro}{\tableofcontents}
% 重定义目录命令，修改标题格式并插入书签。
%    \begin{macrocode}
\tl_new:N \l_@@_toc_title_text
\tl_set:Nn \l_@@_toc_title_text {Table~of~Contents}
\renewcommand\tableofcontents{%
  \clearpage
  \raggedbottom
  \chapter*{\MakeUppercase{\l_@@_toc_title_text}}%
  \addcontentsline{toc}{chapter}{\l_@@_toc_title_text}
  {\@starttoc{toc}}%
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\listoffigures}
% 重定义插图目录命令，修改标题格式并插入书签。
%    \begin{macrocode}
\tl_new:N \l_@@_lof_title_text
\tl_set:Nn \l_@@_lof_title_text {List~of~Figures}
\renewcommand{\cftfigpresnum}{Figure~}
\setlength{\cftfignumwidth}{5em}
\renewcommand\listoffigures{%
  \clearpage
  \chapter*{\MakeUppercase{\l_@@_lof_title_text}}%
  \addcontentsline{toc}{chapter}{\l_@@_lof_title_text}
  {\singlespacing\@starttoc{lof}}%
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\listoftables}
% 重定义表格目录命令，修改标题格式并插入书签。
%    \begin{macrocode}
\tl_new:N \l_@@_lot_title_text
\tl_set:Nn \l_@@_lot_title_text {List~of~Tables}
\renewcommand{\cfttabpresnum}{Table~}
\setlength{\cfttabnumwidth}{5em}
\renewcommand\listoftables{%
  \clearpage
  \begingroup
  \chapter*{\MakeUppercase{\l_@@_lot_title_text}}%
  \addcontentsline{toc}{chapter}{\l_@@_lot_title_text}
  \@starttoc{lot}%
}
%    \end{macrocode}
% \end{macro}
%
% \subsection{前言致谢}
% 
% \begin{environment}{preface}
% 单独制作的前言页。
%    \begin{macrocode}
\NewDocumentEnvironment{preface}{}
{%
  \clearpage
  \chapter*{Preface}
  \addcontentsline{toc}{chapter}{Preface}
}{}
%    \end{macrocode}
% \end{environment}
%
% \begin{environment}{acknowledgements}
% 单独制作的致谢页。
%    \begin{macrocode}
\NewDocumentEnvironment{acknowledgements}{}
{%
  \clearpage
  \chapter*{Acknowledgements}
  \addcontentsline{toc}{chapter}{Acknowledgements}
}{}
%    \end{macrocode}
% \end{environment}
%
% \begin{environment}{dedication}
% 单独制作的 dedication 页。
%    \begin{macrocode}
\NewDocumentEnvironment{dedication}{}
{%
  \clearpage
  \phantomsection
  \addcontentsline{toc}{chapter}{Dedication}
  \itshape
  \vspace*{\fill}
  \centering
}{\par
  \vspace*{\fill}
  }
%    \end{macrocode}
% \end{environment}
%%
% \subsection{封面}
%
% \subsubsection{内部命令}
%
% \begin{variable}{\l_@@_name_degree_tl,\l_@@_abbr_degree_tl}
% 用于存储学位名称的变量。
%    \begin{macrocode}
\tl_new:N \l_@@_name_degree_tl
\tl_new:N \l_@@_abbr_degree_tl
%    \end{macrocode}
% \end{variable}
%
% 判断学位进行命令定义。
%    \begin{macrocode}
\msg_new:nnn { hkustthesis }{ unknown-degree }
  { Unknown~ degree:~ \l_@@_info_degree_tl.\\ Please~ check~ spelling.}
\cs_new_protected:Npn \@@_print_degree_name:
{
\str_if_eq:NNTF { \l_@@_info_degree_tl } { phd }
  {
   \tl_set:Nn \l_@@_name_degree_tl { Doctor~of~Philosophy }
   \tl_set:Nn \l_@@_abbr_degree_tl { PhD }
  }
  {
    \str_if_eq:NNTF { \l_@@_info_degree_tl } { mphil }
    {
     \tl_set:Nn \l_@@_name_degree_tl { Master~of~Philosophy }
     \tl_set:Nn \l_@@_abbr_degree_tl { MPhil }
    }
    { \msg_error:nn { hkustthesis } { unknown-degree } }
  }
}
%    \end{macrocode}
%
% \subsubsection{绘制封面}
% 
% \begin{macro}{\@@_print_titlepage:}
% 封面页。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_print_titlepage:
{
  \cleardoublepage
  \thispagestyle{plain}
  \addcontentsline{toc}{chapter}{Title~Page}
  \begin{center}
    \phantom{[SMAPLE~TITLE~PAGE]}\\[1\baselineskip]
    { \LARGE\bfseries\selectfont\l_@@_info_title_tl}
      \\[5\baselineskip]
      by\\[1\baselineskip]
      \l_@@_info_author_tl\\[5\baselineskip]
    {
      A~Thesis~Submitted~to\\
      The~Hong~Kong~University~of~Science~and~Technology\\
      in~Partial~Fulfilment~of~the~Requirements~for\\
      \@@_print_degree_name:
      the~Degree~of~{\l_@@_name_degree_tl}\\
      in~{\l_@@_name_of_program_tl}
    }\\[3\baselineskip]
    \l_@@_submit_month_tl,~\l_@@_info_city_tl\par%
  \end{center}
  \normalfont
  \clearpage
}
%    \end{macrocode}
% \end{macro}
% 
% \begin{macro}{\maketitle}
% 重定义maketitle生成封面。
%    \begin{macrocode}
\tl_set:Nn \maketitle {\@@_print_titlepage:}
%    \end{macrocode}
% \end{macro}
%
% \subsection{摘要}
%
% \begin{macro}{\@@_print_abstract:}
% 输出摘要页。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_print_abstract:
{
  \cleardoublepage
  \thispagestyle{plain}
  \phantomsection
  \addcontentsline{toc}{chapter}{Abstract}
  {
    \begin{center}
    \phantom{[SAMPLE~ABSTRACT~PAGE]}\\[1\baselineskip]
    { \LARGE\bfseries\selectfont\l_@@_info_title_tl}
      \\[1\baselineskip]
      by~\l_@@_info_author_tl \\[2\baselineskip]
      \l_@@_info_department_tl \\[1\baselineskip]
      The~Hong~Kong~University~of~Science~and~Technology\\[2\baselineskip]
      Abstract
    \end{center}
  }
  \singlespacing\selectfont
}
%    \end{macrocode}
% \end{macro}
%
%    \begin{macrocode}
\NewDocumentEnvironment{abstract} {}
{ \@@_print_abstract: }{ \clearpage }
%    \end{macrocode}
%
% \subsection{Authorization}
% \begin{macro}{\@@_print_authorization_g:}
% 输出授权页。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_print_authorization_g:
{
  \cleardoublepage
  \thispagestyle{plain}
  \phantomsection
  \addcontentsline{toc}{chapter}{Authorization}
  {
    {
    \begin{center}
    \phantom{[SAMPLE~AUTHORIZATION~PAGE]}\\
    \large\bfseries\selectfont\underline{Authorization}\\[2\baselineskip]
    \end{center}
    }
    {\setlength{\parindent}{3em}
    I~hereby~declare~that~I~am~the~sole~author~of~the~thesis.\\

    \par I~authorize~the~Hong~Kong~University~of~Science~and~Technology~
    to~lend~this~thesis~to~other~institutions~or~individuals~for~the~
    purpose~of~scholarly~research.\\
    
    \par I~further~authorize~the~Hong~Kong~University~of~Science~and~
    Technology~to~reproduce~the~thesis~by~photocopying~or~by~other~means,~
    in~total~or~in~part,~at~the~request~of~other~institutions~or~
    individuals~for~the~purpose~of~scholarly~research.
    \\[5\baselineskip]
    }
    {
    \begin{center}
    \makebox[3.5in]{\hrulefill}\\
    \l_@@_info_author_tl \\[1\baselineskip]
    \l_@@_submit_date_tl
    \end{center}
    }
 }
}
%    \end{macrocode}
% \end{macro}
%
%    \begin{macrocode}
\NewDocumentCommand\authorization{}
  {\@@_print_authorization_g:\clearpage}
%    \end{macrocode}
%
% \subsection{Signature~Page}
% \begin{macro}{\@@_print_signaturepage_g:}
% 输出签名页。
%    \begin{macrocode}
\cs_new_protected:Npn \@@_print_signaturepage_g:
{
  \cleardoublepage
  \thispagestyle{plain}
  \phantomsection
  \addcontentsline{toc}{chapter}{Signature~Page}
  {
   \str_if_empty:NTF \l_@@_info_co_supervisor_tl
    {
    \begin{center}
      \str_if_eq:NNTF { \g_@@_disp_committee_tl } { true }
      {
      \phantom{SAMPLE~SIGNATURE~PAGE}\\
      \vspace{-20pt}
      {\LARGE\bfseries\selectfont\l_@@_info_title_tl}
       \\[1\baselineskip]
      by \\[1\baselineskip]
      \l_@@_info_author_tl \\[1\baselineskip]
      This~is~to~certify~that~I~have~examined~the~
      \@@_print_degree_name:
      above~{\l_@@_abbr_degree_tl}~thesis\\
      and~have~found~that~it~is~complete~and~satisfactory~in~all~respects,\\
      and~that~any~and~all~revisions~required~by\\
      the~thesis~examination~committee~have~been~made.\\[3\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_supervisor_tl,~Thesis~Supervisor
       \\[3\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_depthead_tl\\[1\baselineskip]
    \end{center}
      \int_new:N \l_@@_reviewer_clist_len_int
      \int_new:N \l_@@_reviewer_index_int
      \int_set:Nn \l_@@_reviewer_clist_len_int
                  {\clist_count:N \l_@@_info_reviewer_clist}
      \int_set:Nn \l_@@_reviewer_index_int {1}
      \begin{tabular*}{\textwidth}{l@{\extracolsep{\fill}}l}
        Thesis~Examination~Committee & \\
        \int_do_until:nNnn {\l_@@_reviewer_index_int} > 
                           {\l_@@_reviewer_clist_len_int}
        {
          \int_eval:n \l_@@_reviewer_index_int .~ 
          \clist_item:Nn \l_@@_info_reviewer_clist
                         {\l_@@_reviewer_index_int} &
          \clist_item:Nn \l_@@_info_reviewer_dept_clist
                         {\l_@@_reviewer_index_int} \\
          \int_gincr:N \l_@@_reviewer_index_int
        }
        \str_if_empty:NTF {\l_@@_info_reviewer_ext_clist}
        { }
        { \makecell[l]{\int_eval:n {\l_@@_reviewer_clist_len_int + 1} .~ 
                       \clist_item:Nn \l_@@_info_reviewer_ext_clist { 1 } 
                       \\ \phantom{placeholder}} & 
          \makecell[l]{\clist_item:Nn \l_@@_info_reviewer_ext_clist { 2 }} }
      \end{tabular*}
    }
    {
      \phantom{SAMPLE~SIGNATURE~PAGE}\\[1\baselineskip]
      {\LARGE\bfseries\selectfont\l_@@_info_title_tl}
        \\[4\baselineskip]
      by \\[1\baselineskip]
      \l_@@_info_author_tl \\[2\baselineskip]
      This~is~to~certify~that~I~have~examined~the~
      \@@_print_degree_name:
      above~{\l_@@_abbr_degree_tl}~thesis\\
      and~have~found~that~it~is~complete~and~satisfactory~in~all~respects,\\
      and~that~any~and~all~revisions~required~by\\
      the~thesis~examination~committee~have~been~made.\\[4\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_supervisor_tl,~Thesis~Supervisor
       \\[3\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_depthead_tl\\[1\baselineskip]
    \end{center}
    }
    \begin{center}
    \l_@@_info_department_tl \\
    \l_@@_submit_date_tl
    \end{center}
    }
    {
    \begin{center}
      \str_if_eq:NNTF { \g_@@_disp_committee_tl } { true }
      {
      {\LARGE\bfseries\selectfont\l_@@_info_title_tl}
        \\[1\baselineskip]
      by \\[1\baselineskip]
      \l_@@_info_author_tl \\[1\baselineskip]
      This~is~to~certify~that~I~have~examined~the~
      \@@_print_degree_name:
      above~{\l_@@_abbr_degree_tl}~thesis\\
      and~have~found~that~it~is~complete~and~satisfactory~in~all~respects,\\
      and~that~any~and~all~revisions~required~by\\
      the~thesis~examination~committee~have~been~made.\\[2\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_supervisor_tl,~Thesis~Supervisor
       \\[2\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_co_supervisor_tl,~Thesis~Co-supervisor
       \\[2\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_depthead_tl\\[0\baselineskip]
    \end{center}
      \int_new:N \l_@@_reviewer_clist_len_int
      \int_new:N \l_@@_reviewer_index_int
      \int_set:Nn \l_@@_reviewer_clist_len_int
                  {\clist_count:N \l_@@_info_reviewer_clist}
      \int_set:Nn \l_@@_reviewer_index_int {1}
      \begin{tabular*}{\textwidth}{l@{\extracolsep{\fill}}l}
        Thesis~Examination~Committee & \\
        \int_do_until:nNnn {\l_@@_reviewer_index_int} > 
                           {\l_@@_reviewer_clist_len_int}
        {
          \int_eval:n \l_@@_reviewer_index_int .~ 
          \clist_item:Nn \l_@@_info_reviewer_clist 
                         {\l_@@_reviewer_index_int} &
          \clist_item:Nn \l_@@_info_reviewer_dept_clist
                         {\l_@@_reviewer_index_int} \\
          \int_gincr:N \l_@@_reviewer_index_int
        }
        \str_if_empty:NTF {\l_@@_info_reviewer_ext_clist}
        { }
        { \makecell[l]{\int_eval:n {\l_@@_reviewer_clist_len_int + 1} .~ 
                       \clist_item:Nn \l_@@_info_reviewer_ext_clist { 1 }
                       \\ \phantom{placeholder}} & 
          \makecell[l]{\clist_item:Nn \l_@@_info_reviewer_ext_clist { 2 }} }
      \end{tabular*}
    }
    {
      \phantom{SMAPLE~SIGNATURE~PAGE}\\[1\baselineskip]
      {\LARGE\bfseries\selectfont\l_@@_info_title_tl}
        \\[4\baselineskip]
      by \\[1\baselineskip]
      \l_@@_info_author_tl \\[2\baselineskip]
      This~is~to~certify~that~I~have~examined~the~
      \@@_print_degree_name:
      above~{\l_@@_abbr_degree_tl}~thesis\\
      and~have~found~that~it~is~complete~and~satisfactory~in~all~respects,\\
      and~that~any~and~all~revisions~required~by\\
      the~thesis~examination~committee~have~been~made.\\[2\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_supervisor_tl,~Thesis~Supervisor
       \\[2\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_co_supervisor_tl,~Thesis~Co-supervisor
       \\[2\baselineskip]
      \makebox[3.5in]{\hrulefill}\\
      \l_@@_info_depthead_tl\\[1\baselineskip]
    \end{center}
    }
    \begin{center}
    \l_@@_info_department_tl \\
    \l_@@_submit_date_tl
    \end{center}
    }

  }
}
%    \end{macrocode}
% \end{macro}
%
%    \begin{macrocode}
\NewDocumentCommand\signaturepage{}
  {\@@_print_signaturepage_g:\clearpage}
%    \end{macrocode}
%
% \subsection{参考文献}
% 
% biblatex设置。\\
% TODO: \st{Add an option for bib style.} Done.
%    \begin{macrocode}
\RequirePackage[
    style=\g_@@_bib_style_tl,
    %style=numeric-comp,
    %citestyle=authortitle-icomp,
    citestyle=numeric-comp,
    %bibstyle=authoryear,
    %bibstyle=numeric,
    dashed=false,
    sorting=none,
    %sorting=nyt,
    %sortcites=true,
    %autocite=footnote,
    backend=biber, % Compile the bibliography with biber
    hyperref=true,
    backref=true,
    citecounter=true,
    pagetracker=true,
    citetracker=true,
    ibidtracker=context,
    autopunct=true,
    autocite=plain,
    % gbpub=false,         % Uncomment if you do NOT want '[S.l. : s.n.]' 
                           % in reference entries, GitHub Issue (#47)
    % gbnamefmt=lowercase, % Uncomment if you do NOT want uppercase author 
                           % names in reference entries, GitHub Issue (#23)
]{biblatex}
%    \end{macrocode}
%
% 忽略不需要的文献信息。
%    \begin{macrocode}
\AtEveryBibitem{
    \clearfield{abstract}
    \clearfield{issn}
    \clearfield{isbn}
    \clearfield{archivePrefix}
    \clearfield{arxivId}
    \clearfield{pmid}
    \clearfield{eprint}
    \ifentrytype{online}{}{\ifentrytype{misc}{}{\clearfield{url}}}
    % \ifentrytype{book}{\clearfield{doi}}{}
}
%    \end{macrocode}
%
% \subsection{List~of~Publications}
% \begin{macro}{\paperlist}
% 发表文章列表。\\
% CHANGELOG: Add an optional argument to paperlist for customization.
%    \begin{macrocode}
\NewDocumentCommand\paperlist { o m }
{  
  \begin{refsection} 
    \nocite{#2}
    \printbibliography[heading=subbibliography,title=#1]
  \end{refsection}
}
%    \end{macrocode}
% \end{macro}
%
% \subsection{Cross~Reference}
% 由 \pkg{cref} 实现自动化标签名称。
%    \begin{macrocode}
\crefdefaultlabelformat{(#2#1#3)}
\crefname{figure}{Figure}{Figures}
\crefname{table}{Table}{Tables}
\crefname{equation}{Equation}{Equations}
\crefformat{chapter}{Chapter~#2#1#3}
\crefformat{section}{Section~#2#1#3}
\crefformat{subsection}{Subsection~#2#1#3}
\crefformat{subsubsection}{Subsubsection~#2#1#3}
\crefname{appendix}{Appendix}{Appendices}
\crefname{definition}{Definition}{Definitions}
\crefname{axiom}{axiom}{Axioms}
\crefname{property}{Property}{Properties}
\crefname{proposition}{Proposition}{Propositions}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{corollary}{Corollary}{Corollaries}
\crefname{remark}{Remark}{Remarks}
\crefname{condition}{Condition}{Conditions}
\crefname{conclusion}{Conclusion}{Conclusions}
\crefname{assumption}{Assumption}{Assumptions}
%    \end{macrocode}
%
% CHANGELOG: Get rid of all ctex packages.\\
% \pkg{unicode-math} 与 \pkg{bm} 冲突。定义或重定义一些相关命令以规避后者带来的问题。\\
% 注：实际上，使用 \hologo{XeLaTeX} 时已经不需要使用过时的 \pkg{bm} 宏包。\\
% \pkg{hyperref} 
%    \begin{macrocode}
\cs_new_protected:Npx \@@_gadd_ltxhook:nn #1
  { \hook_gput_code:nnn {#1} { \c_novalue_tl } }
\cs_new_protected:Npn \@@_at_end_preamble:n
  { \@@_gadd_ltxhook:nn { begindocument/before } }
\@@_at_end_preamble:n
{
  \NewDocumentCommand \mathbi {m} {\symbfit{#1}}
  \ProvideDocumentCommand \bm {m} {\mathbi{#1}}
  \RenewDocumentCommand \bm {m} {\mathbi{#1}}
  \hypersetup
    {
      pdftitle    = \l_@@_info_title_tl,
      pdfauthor   = \l_@@_info_author_tl,
      pdfcreator  = \c_@@_name_pdf_creator_tl,
      pdfsubject  = to~her
    }
}
%    \end{macrocode}
%
% \subsection{图表浮动体}
% 
% \subsubsection{图片表格}
% 
% 图表位置调整。
%    \begin{macrocode}
\floatsetup[figure]{ % 图名在图下
    capposition=bottom,%
    margins=centering,%
    floatwidth=\textwidth%
}
\floatsetup[table]{ % 表名在表上
    capposition=above,%
    margins=centering,%
    floatwidth=\textwidth%
}
%    \end{macrocode}
% 
% 图表标题样式。
%    \begin{macrocode}
\DeclareCaptionFont{capfont}{
  \rmfamily\selectfont
}
\captionsetup{
  font=normal,%
  labelfont=capfont,
    textfont=capfont,
    strut=no,%
    hypcap=true, % Links point to the top of the figure
    % indention=0pt, % Suppress indentation
    % % parindent=0pt, % Suppress space between paragraphs
    aboveskip=6pt, % Increase the space between the figure and the caption
    belowskip=6pt, % Increase the space between the caption and the table
}
%    \end{macrocode}
%
% \subsubsection{代码}
% 
% 代码样式。\\
% TODO: \st{style settings: finer or remove anything?} No plan. Removed
%    \begin{macrocode}
\floatsetup[lstlisting]{ % Captions for lstlistings
    capposition=above,%
    margins=centering,%
    floatwidth=\textwidth%
}
\lstset{
    basicstyle=\ttfamily\linespread{1}\small\selectfont,
    keywordstyle=\bfseries,% use bold style for keywords
    commentstyle=\rmfamily\itshape,% use italic style for comments
    stringstyle=\ttfamily,
    flexiblecolumns,% ?
    numbers=left,% left-aligned numbering
    showspaces=false,% hide markers for spaces
    showstringspaces=false,
    % captionpos=t,% place the caption at the top ??repeated??
    frame=tb,% show top & bottom sides of the frame
    % linewidth=.8\textwidth,
    % breakatwhitespace=true,
    breaklines=true,
    xleftmargin=1em,xrightmargin=1em,% set the width of the code environment
}
%    \end{macrocode}
%
% \subsubsection{列表}
% 
% 列表环境。
%    \begin{macrocode}
\renewcommand{\labelitemi}{\large\textbullet}
\renewcommand{\labelitemii}{\normalsize\textbullet}
\renewcommand{\labelenumi}{\arabic{enumi}.}
\renewcommand{\labelenumii}{\alph{enumii}.}
%    \end{macrocode}
%
% 去除 item 之前的间隔。
%    \begin{macrocode}
\setlist[itemize]{noitemsep}
\setlist[enumerate]{noitemsep}
\setlist[description]{noitemsep}
%    \end{macrocode}
% 
% \subsection{定理环境}
%
%    \begin{macrocode}
\declaretheoremstyle[
  %spaceabove=.5\thm@preskip,
  %spacebelow=.5\thm@postskip,
  headfont=\bfseries\rmfamily\selectfont,% \scshape,
  notefont=\rmfamily\selectfont,% notebraces={ (}{)},
  bodyfont=\rmfamily\selectfont,
  %headformat={\NAME\space\NUMBER\space\NOTE},
  headpunct={},
  %postheadspace={.5em plus .1em minus .1em},
  %prefoothook={\hfill\qedsymbol}
]{hkustthm}

\theoremstyle{hkustthm}
%    \end{macrocode}
%
% 修改证明环境标题 。
%    \begin{macrocode}
\let\oldproofname=\proofname
\renewcommand*{\proofname}
  {\rmfamily\selectfont{\oldproofname}} 
%    \end{macrocode}
% 
%    \begin{macrocode}
\declaretheorem[
    name=Algorithm,
    style=hkustthm,
    refname={algorithm,algorithms},
    Refname={Algorithm,Algorithms},
    % numberwithin=section,
]{algorithm}
\declaretheorem[
    name=Assumption,
    style=hkustthm,
    refname={assumption,assumptions},
    Refname={Assumption,Assumptions},
    % numberwithin=section,
]{assumption}
\declaretheorem[
    name=Axiom,
    style=hkustthm,
    refname={axiom,axioms},
    Refname={Axiom,Axioms},
    % numberwithin=section,
]{axiom}
\declaretheorem[
    name=Conclusion,
    style=hkustthm,
    refname={conclusion,conclusions},
    Refname={Conclusion,Conclusions},
    % numberwithin=section,
]{conclusion}
\declaretheorem[
    name=Condition,
    style=hkustthm,
    refname={condition,conditions},
    Refname={Condition,Conditions},
    % numberwithin=section,
]{condition}
\declaretheorem[
    name=Corollary,
    style=hkustthm,
    refname={corollary,corollaries},
    Refname={Corollary,Corollaries},
    % numberwithin=section,
]{corollary}
\declaretheorem[
    name=Definition,
    style=hkustthm,
    refname={definition,definitions},
    Refname={Definition,Definitions},
    % numberwithin=section,
]{definition}
\declaretheorem[
        name=Example,
        style=hkustthm,
        refname={example,examples},
        Refname={Example,Examples},
        % numberwithin=section,
]{example}
\declaretheorem[
    name=Lemma,
    style=hkustthm,
    refname={lemma,lemmas},
    Refname={Lemma,Lemmas},
    % numberwithin=section,
]{lemma}
\declaretheorem[
    name=Property,
    style=hkustthm,
    refname={property,properties},
    Refname={Property,Properties},
    % numberwithin=section,
]{property}
\declaretheorem[
    name=Proposition,
    style=hkustthm,
    refname={proposition,propositions},
    Refname={Proposition,Propositions},
    % numberwithin=section,
]{proposition}
\declaretheorem[
    name=Remark,
    style=hkustthm,
    refname={remark,remarks},
    Refname={Remark,Remarks},
    % numberwithin=section,
]{remark}
\declaretheorem[
    name=Theorem,
    style=hkustthm,
    refname={theorem,theorems},
    Refname={Theorem,Theorems},
    numberwithin=section,
]{theorem}
%</class>
%    \end{macrocode}
%
%%
%% \end{implementation}
%
